# Всегда следите и за количеством SQL запросов к БД и за временем их исполнения

Казалось бы очевидный совет, но многие им пренебрегают и в итоге некоторые проекты на один HTTP запрос могут выполнять несколько сотен запросов к базе данных. На какое-то время эта проблема может скрыта кэшированием со стороны вебсервера, но рано или поздно резкая деградация производительности проявит себя.

Всегда старайтесь выполнить задачу, используя минимальное количество запросов к БД, но помните, что большие запросы тоже могут тормозить.

Хорошими инструментами для анализа SQL запросов являются:

* Включенние отладочного логгирования в [Django](https://docs.djangoproject.com/en/1.9/topics/logging/#django-db-backends)
* Использование сторонних приложений [django-dev-server](https://github.com/dcramer/django-devserver) и [django-debug-toolbar](https://github.com/django-debug-toolbar/django-debug-toolbar)
* Включение логгирования в базе данных, например для [PostgreSQL](http://www.postgresql.org/docs/current/static/runtime-config-logging.html). Позволит увидеть причины долгого выполнения запросов, например создание временных файлов при сортировке.
* Используйте [PgBadger](http://dalibo.github.io/pgbadger/) для сбора статистики запросов и их анализа.
